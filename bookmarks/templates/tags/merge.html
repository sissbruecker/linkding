{% load widget_tweaks %}

<turbo-frame id="tag-modal">
  <form method="post" action="{% url 'linkding:tags.merge' %}" data-turbo-frame="_top" novalidate>
    {% csrf_token %}
    <ld-modal class="modal active" data-close-url="{% url 'linkding:tags.index' %}" data-turbo-frame="tag-modal">
      <div class="modal-overlay" data-close-modal></div>
      <div class="modal-container" role="dialog" aria-modal="true">
        {% include 'shared/modal_header.html' with title="Merge Tags" %}
        <div class="modal-body">
          <details class="mb-4">
            <summary>
              <span class="text-bold mb-1">How to merge tags</span>
            </summary>
            <ol>
              <li>Enter the name of the tag you want to keep</li>
              <li>Enter the names of tags to merge into the target tag</li>
              <li>The target tag is added to all bookmarks that have any of the merge tags</li>
              <li>The merged tags are deleted</li>
            </ol>
          </details>

          <div class="form-group {% if form.target_tag.errors %}has-error{% endif %}">
            <label for="{{ form.target_tag.id_for_label }}" class="form-label">Target tag</label>
            <ld-tag-autocomplete input-id="{{ form.target_tag.auto_id }}" input-name="{{ form.target_tag.html_name }}"
                                 input-value="{{ form.target_tag.value|default_if_none:'' }}">
            </ld-tag-autocomplete>
            <div class="form-input-hint">
              Enter the name of the tag you want to keep. The tags entered below will be merged into this one.
            </div>
            {% if form.target_tag.errors %}
              <div class="form-input-hint">
                {{ form.target_tag.errors }}
              </div>
            {% endif %}
          </div>

          <div class="form-group {% if form.merge_tags.errors %}has-error{% endif %}">
            <label for="{{ form.merge_tags.id_for_label }}" class="form-label">Tags to merge</label>
            <ld-tag-autocomplete input-id="{{ form.merge_tags.auto_id }}" input-name="{{ form.merge_tags.html_name }}"
                                 input-value="{{ form.merge_tags.value|default_if_none:'' }}">
            </ld-tag-autocomplete>
            <div class="form-input-hint">Enter the names of tags to merge into the target tag, separated by spaces.
              These tags will be deleted after merging.
            </div>
            {% if form.merge_tags.errors %}
              <div class="form-input-hint">
                {{ form.merge_tags.errors }}
              </div>
            {% endif %}
          </div>
        </div>
        <div class="modal-footer d-flex justify-between">
          <button type="button" class="btn btn-wide" data-close-modal>Cancel</button>
          <button type="submit" class="btn btn-primary btn-wide">Merge Tags</button>
        </div>
      </div>
    </ld-modal>
  </form>
</turbo-frame>
